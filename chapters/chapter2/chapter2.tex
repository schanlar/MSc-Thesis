\documentclass[../../main/thesis_msc.tex]{subfiles}


%\setcounter{chapter}{0}






\begin{document}

    \chapter{Methods}
    
    	For the puproses of this thesis we performed numerical calculations using the one dimensional, stellar evolution code \textbf{M}odules for \textbf{E}xperiments in \textbf{S}tellar \textbf{A}strophysics (\texttt{MESA}) \citep{Paxton2011, Paxton2013, Paxton2015, Paxton2018}. In this section, we present the very basic aspects of \texttt{MESA} and the physical assumptions we used in our attempt to model the evolution of single and binary stellar systems.
    	
    		\section{Modules for Experiments in Stellar Astrophysics}
    		
    			%Write 2-3 pages of the MESA basics and how it works (Newton iterations etc). Consider possible subsections
    			\texttt{MESA} is an open-source stellar evolution code which provides a modular approach to stellar modelling. Each of the available modules is responsible for the delivery of a specific aspect of the required physics (e.g. microphysics modules provide necessary equations of state and nuclear networks, utilization of macrophysics modules to treat mixing processes etc) in order to succesfully construct a computational stellar model.
    			
    			For a spherically symmetric star in hydrostatic equilibrium the structure of the star is governed by the following four differential equations
    			
    			\begin{eqnarray}
    				\frac{\partial r}{\partial m} &=& \frac{1}{4 \pi r^2 \rho} \label{eq:2.1} \\ \nonumber \\
    				\frac{\partial P}{\partial m} &=& - \frac{G m}{4 \pi r^4} \label{eq:2.2 }\\ \nonumber \\
    				\frac{\partial l}{\partial m} &=& \epsilon - \epsilon_{\nu} + \epsilon_g \label{eq:2.3} \\ \nonumber \\
    				\frac{\partial T}{\partial m} &=& - \frac{T}{P} \frac{G m}{4 \pi r^4} \nabla = \frac{T}{P} \frac{\partial P}{\partial m} \nabla \label{eq:2.4}
    			\end{eqnarray}
    			and its evolution by the composition equations
    			
    			\begin{eqnarray}
    				\frac{\partial X_i}{\partial t} = \frac{m_i}{\rho} \left( \sum_j r_{ji} - \sum_k r_{ik} \right), \hspace{0.5cm} \text{i = 1, $\dots$, I.} \label{eq:2.5}
    			\end{eqnarray}
    			where a full explanation of the symbols used here is given in \cite[][p. 89]{Kipp_book}. 
    			
    			\texttt{MESA} is able to simultaneously solve the coupled structure and composition equations \hyperref[eq:2.1]{(2.1)-(2.5)} without the need of operator splitting, where we alternately solve the spatial (structure) and temporal (evolution) equations. This is achieved by exploiting a generalized Newton-Raphson iterative solution which is most commonly referred to as the \emph{Henyey method} \citep[][p. 106]{Wilson1981, Kipp_book}; a grid of finite mesh points has to be set up, essentially dividing the structure into a large number of discrete mass cells where the differential equations need to be calculated. Assuming appropriate boundary conditions, a trial solution has to be guessed in advance which will be later improved after a number of consecutive iterations, and until the required degree of accuracy has been reached in order for the code to converge on a final solution. If after a specified number of iterations the model fails to converge, \texttt{MESA} will retry the calculation using a smaller timestep; this process will be repeated until the code finds an acceptable model to converge or until it reaches a limit in the timestep reduction.
    			
    			Finally, during the star's evolution, \texttt{MESA} will automatically adjust the mesh and redistribute it based on the structure and composition profiles of the model at the beginning of each timestep. For a proper insight into timestep selection and mesh refinement see \cite{Paxton2011}.
    			
    		\section{Physical assumptions}
    		
    			All helium stars were created with \texttt{MESA} (version - r10398) in single star evolution by starting with a non-rotating ZAMS star of $30$ M$_{\odot}$ and solar composition ($X = 0.70$, $Y = 0.28$, $Z = 0.02$). The star was left to evolve until hydrogen depletion in its centre, at which point the hydrogen envelope was artificially removed exposing a naked helium core of $\sim 9$ M$_{\odot}$ with homogeneous composition ($Y = 0.98$, $Z = 0.02$). Lower mass helium stars were created by artificially removing the outer layers of the aforementioned helium core.
    			
    				\subsection{Single stars}
    				
    					In order to study the generic behaviour of the model stars before putting them in a binary configuration, we evolved non-rotating, non-magnetic helium stars in the mass range $2.0$ M$_{\odot}$ - $9.0$ M$_{\odot}$. In all cases, the calculations are continued until the core collapse phase, where the core reaches an infall speed limit of $1000$ km s$^{-1}$, or until the code cannot find another acceptable model to continue. For the nuclear reactions network we chose the \texttt{approx21\_cr60\_plus\_co56.net} that is included in \texttt{MESA} and considers twenty-two nuclear species. Moreover, we considered ion and electron screening corrections as described in \cite{PCR2009} and \cite{Itoh2002} respectively.
    					
    					Convection was treated according to the mixing-length theory prescription of \cite{MLT_Henyey} with a mixing-length parameter of $\alpha_{\text{ML}} = 2.0$. Furthermore, we used the Ledoux criterion for convective instability adopting an efficiency parameter of $\alpha_{\text{SEM}} = 1.0$ for semiconvection \citep{Langer1991}, and a diffusion coefficient $D_{\text{TH}} = 1.0$ for thermohaline mixing. Both semiconvection and thermohaline mixing are treated by \texttt{MESA} as diffusive processes \citep{Langer1983, Kipp_thermohaline}. Convective core overshooting was not applied in any of our models since, as noted by \cite{Tauris_ultra}, mixing can be hampered in core helium-burning stars due to mass growth of the convective core with time. Nevertheless, for the non-burning convective regions, we adopted a $f_{\text{ov}} = 0.0005$ value where the latter parameter is defined in \cite{Herwig2000} as a fraction of the local pressure scale height $H_p$, and is connected to the diffusion coefficient $D_{\text{OV}}$ via the relation
    					
    					\begin{eqnarray}
    						\label{eq:OV_diff}
    						D_{\text{OV}} = D_0 \exp \left( - \frac{2z}{H_v} \right), \hspace{0.5cm} H_v = f_{\text{ov}} \cdot H_p
    					\end{eqnarray}
    					
    					Mass loss rates due to stellar winds were implemented using the "\texttt{Dutch}" wind scheme \citep{Dutch}. In our case, this implies two different rates depending on the effective temperature of the star; for $T_{\text{eff}} > 10^4$ K and a surface abundance of hydrogen $X < 0.4$ by mass fraction (which is always satisfied for the models we developed), we apply the prescription of \cite{Nugis2000} with a scaling factor of $\eta = 0.8$. However, we also calculated some models using the canonical value of $\eta = 1$, and some models with an enhanced scaling factor of $\eta = 1.58$ as proposed by \cite{yoon17}. For $T_{\text{eff}} < 10^4$ K the mass loss rate follows the prescription of \cite{deJager1988}. All the baseline parameters we adopted above are summarized in \hyperref[tab:parameters_single]{Table 2.1}. Finally, we should mention that in most cases the spatial ($\delta_{\text{mesh}}$) and temporal resolution ($\sigma_t$) were kept constant unless otherwise stated.
    					
    					\begin{table} [!h]
    						\begin{center}
    							\caption{Physical parameters for single helium stars}
    							\label{tab:parameters_single}
    						\end{center}
    						\centering
    						\begingroup
    							\setlength{\tabcolsep}{0.1\textwidth}
    							\begin{tabular}{cc}
    								\hline \hline \\
    							
    								Parameter & Value(s) \\\\
    								\hline \\
    								Convection ($\alpha_{\text{ML}}$) & $2.0$ \\\\
    							
    								Semiconvection ($\alpha_{\text{SC}}$) & $1.0$ \\\\
    							
    								Thermohaline ($D_{\text{TH}}$) & $1.0$ \\\\
    								
    								Overshooting ($f_{\text{ov}}$) & $0.0005$ \\\\
    							
    								Wind scaling factor ($\eta$) & $0.8$, $1.0$, $1.58$ \\\\
    								
    								Mesh Delta Coefficient ($\delta_{\text{mesh}}$) & $1.0$ \\\\
    								
    								Variance Control Target ($\sigma_t$) & $10^{-16}$ \\\\
    								\hline \hline
    							\end{tabular}
    						\endgroup
    					\end{table}
    					
    				\subsection{Binary systems}
    				
    					For the binary systems
    
    
    
    
\end{document}
